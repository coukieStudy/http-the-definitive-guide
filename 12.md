# 12장. 기본 인증

 인증: 사용자가 누구인지 서버에 증명하는 행위 - 보통 사용자 이름과 비밀번호를 입력하는 방식으로 진행된다.
 
 요즘 웹사이트들 대부분은 보안을 더 강화해서 HTTP 자체 인증 기능보다는 각각의 인증 모듈을 직접 구현하지만, 이 장에서는 HTTP 기본 인증을 다룬다.
 
 
 
 ### HTTP의 인증요구/응답 프레임워크
 **HTTP 인증 모델**
 
 ![image](https://user-images.githubusercontent.com/37106166/113886557-bee20100-97fb-11eb-855c-16409e58d67f.png)

 **각 단계에서 사용되는 인증 프로토콜과 헤더**
| 단계 | 헤더 | 설명 | 메서드/상태 |
|---|---|---|---|
| 요청 |  |   |  GET |
|  인증 요구  |  WWW-Authenticate |  사용자에게 사용자 이름과 비밀번호를 제공하라는 의미로 요청을 반려한다. 서버는 WWW-Authenticate 헤더에 인증 영역(realm)을 설명한다|  401 Unauthorized |
|  인증 |  Authorization |  인증 알고리즘, 사용자 이름, 비밀번호 | GET  |
|  성공 |  Authentication-Info | 인증정보가 정확하면 요청했던 문서와 함께 응답  | 200 OK  |


**보안 영역**

웹 서버가 다음 두 보안 영역을 가진다고 가정하자
* 회사 재무 영역
* 회원들의 가족 사진 영역

회사의 CEO는 회사의 재무에는 접근할 수 있지만 회원들의 가족 사진 영역에는 접근할 수는 없을 것이다. 이 정보를 realm 파라미터에 기술한다.

HTTP/1.0 401 Unauthorized <br>
WWW-Authenticate: Basic realm="Corporate Financials"

### 기본 인증

* 인증 요구: WWW-Authenticate: Basic realm="<문서 영역>"
* 응답: Authorization: Basic <base-64로 인코딩한 사용자 이름과 비밀번호>

**Base-64 이름/비밀번호 인코딩**

HTTP 기본 인증은 사용자 이름과 비밀번호를 콜론으로 이어서 합치고, base-64 인코딩 메서드를 사용해 인코딩한다. <br>
Base-64 인코딩은 바이너리, 텍스트, 국제 문자 데이터 문자열을 전송 가능한 문자인 알파벳으로 변환하기 위해 발명되었다. 이 방식은 국제 문자나 HTTP 헤더에서 사용할 수 없는 문자들 (큰따옴표나 개행문자)를 보내야 할 때 유용하게 사용할 수 있다. <br>

**프락시 인증**

어떤 회사는 사용자들이 회사의 서버에 접근하기 전에 프락시 서버를 거치게 해서 사용자를 인증한다. 프락시 인증은 헤더와 상태 코드만 다르고 절차는 동일하다.
![image](https://user-images.githubusercontent.com/37106166/113891747-55182600-9800-11eb-88a7-910580c8aff9.png)



### 기본 인증의 보안 결함

1. Base-64 인코딩의 취약함. Base64 인코딩은 누구나 디코딩할 수 있기 때문에 인코딩된 사용자 이름과 비밀번호는 사실상 비밀번호를 그대로 보내는 것과 다름이 없다.
2. 보안 비밀번호가 디코딩하기에 더 복잡한 방식으로 인코딩되어 있다고 하더라도, 여전히 제 3자가 인코딩된 이름과 비밀번호를 캡쳐한 다음 그것을 원 서버에 보내서 인증에 성공하고 서버에 접근할 수 있다. 기본 인증은 이런 재전송 공격에 취약하다
3. 기본인증이 보안이 뚫려도 치명적이지는 않은 어플리케이션에 사용된다 하더라도, 위험할 수 있다. 일반 사용자들은 보통 여러 사이트에 대해 동일한 아이디와 비밀번호를 사용하기 때문에, 무료 인터넷 이메일과 같은 사이트에서 사용자 이름과 비밀번호 문자열을
 그대로 캡처하고, 동일한 사용자 이름과 비밀번호로 중요한 다른 사이트에 접근할 수도 있다.
4. 메시지의 인증 헤더를 수정하지는 않지만, 그 외 다른 부분을 수정해서 트랜잭션의 본래 의도를 바꿔버리는 프락시나 중개자가 중간에 개입하는 경우, 기본 인증은 정상적인 동작을 하지 않을 수 있다.
5. 기본 인증은 가짜 서버의 위장에 취약하다. 만약 사용자가 가짜 서버에 연결되어 있는데도, 기본 인증을 수행하는 검증된 서버에 연결되어 있다고 믿고 있다면 사용자는 가짜 서버에 이름과 비밀번호의 정보를 제공하게 될 것이다.








